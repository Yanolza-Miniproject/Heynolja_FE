# ✨미니프로젝트 4조 - 아버지날보고있다면정답을알려조✨

## _🏖️ 행복한 여행, 즐거운 시간. 'HEY놀자!' 🏖️_

> 바쁜 일상에 지친 여러분, 다음 목적지는 휴식입니다.
> 나의 소중한 하루를 선사할 곳을 'HEY놀자'에서 만나보세요!

#### ✅ 배포 주소 : https://heynolja-mini-4.vercel.app/

```
* 테스트 계정 정보
ID : admin@admin.com
PW : qwert1234
```

## 'HEY놀자'는 이런 곳이에요.

- 내 위치 기반/ 인기순 /주차 가능 숙소 등 다양한 카테고리의 숙소를 보실 수 있어요.
- 지역별, 숙소 타입별, 추가 옵션 여부 등 내 입맛에 맞는 숙소를 찾아볼 수 있어요.
- 숙소별 상세 안내, 일자별 객실 가능 여부 등의 다양한 정보를 확인할 수 있어요.
- 마음에 쏙 드는 숙소는 내 카트에 담아두거나, 결제하여 예약할 수 있어요.
- 언제라도 꼭 가고 싶은 숙소, ❤️[찜하기] 기능을 이용해보세요.

## 프로젝트 세부 정보

### 📍개발 환경

<img alt="visualstudiocode" src="https://img.shields.io/badge/visualstudiocode-007ACC.svg?&style=for-the-badge&logo=visualstudiocode&logoColor=white"/> <img alt="git" src="https://img.shields.io/badge/git-F05032.svg?&style=for-the-badge&logo=git&logoColor=white"/> <img alt="github" src="https://img.shields.io/badge/github-181717.svg?&style=for-the-badge&logo=github&logoColor=white"/> <img alt="eslint" src="https://img.shields.io/badge/eslint-58A616.svg?&style=for-the-badge&logo=eslint&logoColor=white"/> <img alt="prettier" src="https://img.shields.io/badge/prettier-F7B93E.svg?&style=for-the-badge&logo=prettier&logoColor=white"/> <img alt="husky" src="https://img.shields.io/badge/husky-FFE033.svg?&style=for-the-badge&logo=husky&logoColor=white"/> <img alt="vite" src="https://img.shields.io/badge/vite-646CFF.svg?&style=for-the-badge&logo=vite&logoColor=white"/>

### 📍배포

<img alt="vercel" src="https://img.shields.io/badge/vercel-1BB3A4.svg?&style=for-the-badge&logo=vercel&logoColor=white"/>

### 📍사용 기술

<img alt="react" src="https://img.shields.io/badge/react-61DAFB.svg?&style=for-the-badge&logo=react&logoColor=black"/> <img alt="typescript" src="https://img.shields.io/badge/typescript-3178C6.svg?&style=for-the-badge&logo=typescript&logoColor=white"/> <img alt="reactrouter" src="https://img.shields.io/badge/reactrouter-CA4245.svg?&style=for-the-badge&logo=reactrouter&logoColor=white"/> <img alt="recoil" src="https://img.shields.io/badge/recoil-3578E5.svg?&style=for-the-badge&logo=recoil&logoColor=white"/> <img alt="emotion" src="https://img.shields.io/badge/emotion-D26AC2.svg?&style=for-the-badge&logo=emotion&logoColor=white"/> <img alt="reactquery" src="https://img.shields.io/badge/reactquery-FF4154.svg?&style=for-the-badge&logo=reactquery&logoColor=white"/> <img alt="axios" src="https://img.shields.io/badge/axios-F9CB61.svg?&style=for-the-badge&logo=axios&logoColor=black"/> <img alt="msw" src="https://img.shields.io/badge/msw-9A8555.svg?&style=for-the-badge&logo=msw&logoColor=white"/> <img alt="jest" src="https://img.shields.io/badge/jest-C21325.svg?&style=for-the-badge&logo=jest&logoColor=white"/>

### 📍협업 툴

<img alt="notion" src="https://img.shields.io/badge/notion-E6E6E6.svg?&style=for-the-badge&logo=notion&logoColor=black"/> <img alt="figma" src="https://img.shields.io/badge/figma-F24E1E.svg?&style=for-the-badge&logo=figma&logoColor=white"/> <img alt="slack" src="https://img.shields.io/badge/slack-4608AD.svg?&style=for-the-badge&logo=slack&logoColor=white"/> <img alt="zep" src="https://img.shields.io/badge/zep-EC008C.svg?&style=for-the-badge&logo=zep&logoColor=white"/>

## 👪 아버지날보고있다면정답을알려조 팀원 소개

<table>
  <tr>
    <td align="center" width="150px">
      <a href="https://github.com/2YH02" target="_blank">
        <img src="https://avatars.githubusercontent.com/u/125336070?v=4" alt=
        "이용훈 프로필" />
      </a>
    </td>
    <td align="center" width="150px">
      <a href="https://github.com/suyeonnnnnnn" target="_blank">
        <img src="https://avatars.githubusercontent.com/u/92326949?v=4" alt="박수연 프로필" />
      </a>
    </td>
    <td align="center" width="150px">
      <a href="https://github.com/ewinkite" target="_blank">
        <img src="https://avatars.githubusercontent.com/u/139189610?v=4" alt="이승연 프로필" />
      </a>
    </td>
    </td>
    <td align="center" width="150px">
      <a href="https://github.com/LikeFireAndSky" target="_blank">
        <img src="https://avatars.githubusercontent.com/u/107862297?v=4"alt="김민섭 프로필" />
      </a>
    </td>
    <td align="center" width="150px">
      <a href="https://github.com/mysdpy30s" target="_blank">
        <img src="https://avatars.githubusercontent.com/u/137375435?v=4"alt="이연수 프로필" />
      </a>
    </td>
  </tr>
  <tr> 
    <td align="center">
      <a href="https://github.com/2YH02" target="_blank">
        이용훈<br />
        Frontend & 팀장
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/suyeonnnnnnn" target="_blank">
        박수연<br />
        Frontend
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/ewinkite" target="_blank">
        이승연<br />
        Frontend
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/LikeFireAndSky" target="_blank">
        김민섭<br />
        Frontend
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/mysdpy30s" target="_blank">
        김미정<br />
        Frontend
      </a>
    </td>
  </tr>
</table>
<br>

## 💻 팀원 별 구현 사항

|  이름  | 역할 |             <div align="center">개발 내용</div>              |
| :----: | :--: | :----------------------------------------------------------: |
| 이용훈 | 팀장 |                    장바구니</br>결제 완료                    |
| 박수연 | 팀원 |               숙소 상세</br>방 타입 상세</br>                |
| 이승연 | 팀원 |                주문하기</br> 마이페이지</br>                 |
| 김민섭 | 팀원 |        좋아요 기능 </br> 검색 결과 페이지 </br> 배포         |
| 김미정 | 팀원 | 공통 컴포넌트 제작 </br> 검색(필터) 페이지 </br> 메인 페이지 |

## 🪄 주요 구현 내용

### ⭐ 테마별 숙소 추천 로직 구현

- 사용자의 빠른 선택을 도울 수 있도록 GPS 기준 지역별 숙소 추천, 인기 숙소 안내 등의 기능을 제공합니다.

### ⭐ 회원가입, 로그인 기능 및 인증, 404페이지

- 이메일과 비밀번호 기준으로 회원가입을 진행하며, 이를 기준으로 로그인 할 수 있습니다.
- 인증이 필요한 페이지의 경우 미인증 회원이 접근할 시 로그인 페이지로 이동됩니다.
- 접근이 불가한 주소로 이동 시 404페이지로 이동합니다.

### ⭐ 숙소 조회를 위한 다양한 검색 필터 지원, 개별 상품 페이지 제공

- 숙소 타입, 장소, 추가 옵션별로 원하는 카테고리를 선택하여 숙소를 조회할 수 있습니다.
- 미선택시 전체 상품 조회가 가능합니다.
- 특정 숙소 클릭시 해당 숙소에 대한 상세 정보와 품절여부를 확인할 수 있으며 장바구니 담기 및 바로 주문하기를 진행할 수 있습니다.

### ⭐ 장바구니, 결제하기

- 숙소 상세페이지를 통해 희망하는 날짜/인원수를 설정하여 장바구니에 추가할 수 있습니다.
- 장바구니에서 결제 진행할 숙소를 선택하고, 결제하기 페이지로 이동할 수 있습니다.
- 결제하기 페이지내에서 주문하려는 상품을 다시 한 번 확인하고, 만 14세 이상 이용 동의 체크박스를 필수로 입력 받은 후 결제할 수 있습니다.
- 결제 완료된 경우 완료 페이지내에서 결제한 정보를 확인할 수 있습니다.

### ⭐ 회원의 경우 결제 이력, 장바구니, 찜목록 관리 기능 제공

- 여태 주문한 모든 주문 이력을 건별로 상세하게 확인할 수 있습니다.
- 장바구니에 담아둔 상품의 데이터를 보여주며, 실제 결제할 상품을 선택하고 진행할 수 있습니다.
- 하트 아이콘을 통해 찜목록에 추가했던 숙소들을 확인할 수 있습니다.

## ⚒️ 주요 에러 및 해결 방법

<details>
<summary style="font-size: 22px">access token을 헤더에 담아오면서 발생한 문제</summary>
<div markdown="1">
  
문제: 프로젝트에서 access token을 서버에서 http 헤더에 담아서 보내주는데 배포 환경에서 값을 인식 못하는 문제

해결: 헤더의 키값이 access*token 이라고 되어 있고, 배포 환경에서 nginx에서 헤더의 키값에 *(언더바)가 있으면 자동으로 제거하고 전달하면서 값을 제대로 못받아오는 거여서

이런식으로 작성되었던 코드를

```javascript
headers["access_token"];
```

배포 main브랜치에서 임시로 코드를 아래와 같이 바꿈

```javascript
headers["access-token"];
```

</div>
</details>

<br>

## 객체 내의 여러 값에 접근할 땐 destructuring을 활용

### 문제 사항

객체 내의 여러 값에 접근할 때 너무 많은 프로토타입 체인이 필요하다.

### 해결 과정

axios의 data를 destructuring을 활용하여 작성하니 코드가 한결 깔끔해진 것 같음 앞으로 axios의 return data에서 많은 프로퍼티에 접근할 때는 destructuring을 사용

```javascript
export const fetchSignin = async ({ email, password }: SignInInputs) => {
  const { data, headers } = await baseInstance.post("members/login", {
    email,
    password,
  });

  const returnData = {
    accessToken: headers["access_token"],
    refreshToken: headers["refresh_token"],
    message: data.message,
    memberId: data.data.memberId,
    nickname: data.data.nickname,
  };

  return returnData;
};
```

## Conditional Objects를 다루는 방법

### 문제 사항

필요한 쿼리 파라미터만 보내야 하기 때문에 조건부로 query parameter를 넣어주어야 겠다고 생각했습니다.

```javascript
const data = await authInstance.get(
  `accommodations?page=${pageParam}${regionUrl}${typeUrl}${categoryParkingUrl}${categoryCookingUrl}${categoryPickupUrl}`,
);
```

### 문제 인식

문자열에 어떤 값이 들어갈 지 도 모르고, 추적도 어려운 것 같습니다. 혹여나 다른 사람이 코드를 수정한다 하더라도 정말 너무 어렵고 주먹구구식으로 작성된 코드라는 것을 알 수 있었습니다. 따라서 axios의 params object를 활용하였습니다.

### 해결 과정

1. 객체의 Spread Operator를 사용

가장 먼저 params 객체 자체를 만들어주는 방법에 대해서 생각해보았습니다. 조건부에 따라서 params 객체를 반환하는 함수를 만들어서 관리하자는 것이 처음 생각이었습니다.

```javascript
const validParams = (param: string, value: number | boolean) => {
  return value === false ? {} : { [param]: String(value) };
};

export const fetchCatgory = async (
  pageParam: number,
  props: CategoryFilterParams,
) => {
  const params = {
    ...validParams("region01", props.region01),
    ...validParams("type", props.type),
    ...validParams("categoryParking", props.categoryParking),
    ...validParams("categoryCooking", props.categoryCooking),
    ...validParams("categoryPickup", props.categoryPickup),
  };

  const baseUrl = `accommodations?page=${pageParam}`;

  try {
    const data = isLoggedIn()
      ? await authInstance.get(baseUrl, { params })
      : await baseInstance.get(baseUrl, { params });

    return data.data;
  } catch (error) {
    return error;
  }
};
```

해당 과정을 거치니 기존 URL에 잘못된 정보가 들어가거나, 코드의 가독성이 불편한 문제는 어느정도 해결된 것 같았습니다. 그러나 코드가 길어지고 객체를 6개 만들어서 spread operator를 통해 푸는 형식이다 보니까 가독성도 안 좋고, 코드도 길어지는 단점이 있었던 것 같습니다. 또한 코드가 반복되니까 불필요한 코드 작성도 들어간 것 같았습니다..

2. for in을 사용해서 객체에 넣기

객체의 key 값을 순회할 수 있는 for in을 사용해서 객체를 만들기로 하였습니다. props를 분리하고, 필요한 props를 for in으로 순회하면서 유효한 프로퍼티만 params 객체에 추가하려고 하였습니다.

```javascript
export const fetchCatgory = async (
  pageParam: number,
  props: CategoryFilterParams,
) => {

  type paramsType3 = Record<keyof CategoryFilterParams, string>;

  const params: Partial<paramsType3> = {};

  for (const key in props) {
    if (props[key as keyof CategoryFilterParams] !== false) {
      params[key as keyof paramsType3] = String(
        props[key as keyof CategoryFilterParams],
      );
    }
  }

  const baseUrl = `accommodations?page=${pageParam}`;

  try {
    const data = isLoggedIn()
      ? await authInstance.get(baseUrl, { params })
      : await baseInstance.get(baseUrl, { params });

    return data.data;
  } catch (error) {
    return error;
  }
};
```

다음과 같이 코드를 작성하니 불필요한 코드의 수가 줄어들고 가독성 또한 좋아진 느낌이었습니다. 그러나 코드에서 반복문을 사용하면 코드에서 테스트할 경우들이 많아지고 side effect가 발생할 수 도 있다는 것을 배웠습니다. 따라서 이 점을 개선해볼 필요가 있었습니다.

3. Object.entries().reduce 활용

중점은 반복을 돌면서 하나하나 축적해 나아가는 기능이었습니다. 이를 위해서는 reduce 고차함수가 필요했고 reduce를 적용하기 위해서 Object.entries()라는 메서드를 사용할 수 있다는 것을 알 수 있었습니다. 따라서 props를 Object.entries()를 사용해서 배열로 만들고 reduce로 원하는 객체를 만들었습니다.

```javascript
export const fetchCatgory = async (
  pageParam: number,
  props: CategoryFilterParams,
) => {
  type paramsType3 = Record<keyof CategoryFilterParams, string>;

  const initialParams: Partial<paramsType3> = {};

  const params: Partial<paramsType3> = Object.entries(props).reduce(
    (acc, [key, value]) => {
      if (value !== false) {
        acc[key as keyof paramsType3] = String(value);
      }
      return acc;
    },
    initialParams,
  );

  const baseUrl = `accommodations?page=${pageParam}`;

  try {
    const data = isLoggedIn()
      ? await authInstance.get(baseUrl, { params })
      : await baseInstance.get(baseUrl, { params });

    return data.data;
  } catch (error) {
    return error;
  }
};
```

코드가 훨씬 더 가독성이 있고 간결해진 것 같습니다. 고차함수를 사용하다보니 반복문에 대한 부작용을 걱정하지 않아도 되는 것 같습니다.

### 추가 공부 사항

Axios의 get Method는 두번째 파라미터로 쿼리파라미터에 대한 파라미터 프로퍼티를 받는다. 따라서 두번째 파라미터 객체안에 들어갈 쿼리 파라미터 객체를 넣어주어야 한다.

## 🎞️시연 영상

### ⭐ 로그인, 메인페이지

https://github.com/Yanolza-Miniproject/frontend/assets/125336070/a68ebb7b-42f5-49dd-bf92-661048600cd6

### ⭐ 전체 상품 목록 조회

https://github.com/Yanolza-Miniproject/frontend/assets/125336070/279724f6-8acc-4f17-8f04-8c6247a21397

### ⭐ 조건에 맞는 상품 검색

https://github.com/Yanolza-Miniproject/frontend/assets/125336070/67ea045a-cab6-4c6f-9d22-a2b8e1f66e79

### ⭐ 개별 상품 조회 + 상품 옵션 선택

https://github.com/Yanolza-Miniproject/frontend/assets/125336070/c60f2895-c9fb-42c8-bb76-739c079c4463

### ⭐ 장바구니

https://github.com/Yanolza-Miniproject/frontend/assets/125336070/3d6bedc1-ee6f-4322-9046-7f406ab6eac7

### ⭐ 마이페이지 주문 결과 확인

https://github.com/Yanolza-Miniproject/frontend/assets/125336070/71dece7b-4643-403f-bde9-b610d0eb99f9

## 개인 역량 회고

<details>
<summary style="font-size: 18px">이용훈</summary>
<div markdown="1">

- 느낀점
  - 백엔드 개발자와 처음 협업해보면서 프론트엔드, 백엔드 개발자가 같이 작성하는 API 문서에 대한 중요성이 크게 느껴졌습니다.
  - 처음 사용해보는 라이브러리를 팀원과 같이 공유하며 빠르게 공부해 나아갈 수 있어서 매우 좋았습니다.

</div>
</details>

<br>

<details>
<summary style="font-size: 18px">박수연</summary>
<div markdown="1">

- 느낀점

</div>
</details>

<br>

<details>
<summary style="font-size: 18px">이승연</summary>
<div markdown="1">

- 느낀점

</div>
</details>

<br>

<details>
<summary style="font-size: 18px">김민섭</summary>
<div markdown="1">

- 느낀점
  - 테스트 코드를 작성해보면서 테스트 코드를 짜기 쉬운 코드는 코드 자체가 로직이 간단하고 하나의 기능만을 담당하는 컴포넌트라는 것을 알 수 있었고, 코드의 관심사 분리가 더욱 중요하다는 것을 알 수 있었다.
  - 테스트 코드를 작성하니 리펙토링을 할 때도 여러 에러를 잡을 수 있고 같은 기능을 동작하게 할 수 있어서 리펙토링이 훨씬 수월했다.
  - 컨벤션을 확실하게 맞추고 가야겠다는 것을 느꼈다. 컨벤션이 확실하게 잡히지 않다보니 다양한 코드의 스타일이 나와서 코드의 통일성을 저해하는 느낌을 받았다.
  - 백엔드팀과 함께 작업을 하면서 어떻게 소통을 해야 하는 지 알 수 있었다. 우리만의 언어가 아니라 누가 들어도 쉽게 이해할 수 있는 언어로 대화를 해야 한다는 것을 알 수 있었다.

</div>
</details>

<br>
<details>
<summary style="font-size: 18px">김미정</summary>
<div markdown="1">

- 느낀점

</div>
</details>

<br>
